<?xml version="1.0" ?><PE文件结构 description="这是一个PE格式的树状结构。"><PE文件头部 description=""><DOS头 description="为了保持与16位系统的兼容，PE里依旧保留了16位系统下的标准可执行程序执行时所必需的文件头(DOS MZ 头)和指令代码(DOS Stub)"><IMAGE_DOS_HEADER name="DOS MZ头" size="64"><e_magic description="EXE标志，“MZ”" size="WORD"/><e_cblp description="最后(部分)页中的字节数" size="word"/><e_cp description="文件中的全部和部分页数" size="word"/><e_crlc description="重定位表中指针数" size="word"/><e_cparhdr description="头部尺寸，以段落为单位" size="word"/><e_minalloc description="所需最小附加段" size="word"/><e_maxalloc description="所需的最大附加段" size="word"/><e_ss description="初始的SS值(相对偏移量)" size="word"/><e_sp description="初始的SP值" size="word"/><e_csum description="补码校验值" size="word"/><e_ip description="初始的IP值" size="word"/><e_cs description="初始的CS值" size="word"/><e_lfarlc description="重定位表的字节偏移量" size="word"/><e_ovno description="覆盖号" size="word"/><e_res description="保留字" size="word 4 dup"/><e_oemid description="OEM标识符(相对e_oeminfo)" size="word"/><e_oeminfo description="OEM信息" size="word"/><e_res2 description="保留字" size="word 10 dup"/><e_lfanew description="PE头相对于文件的偏移地址" size="dword"/></IMAGE_DOS_HEADER><DOS_Stub description="DOS Stub 部分是程序在DOS系统下的指令字节码 " name="DOS Stub" size="不确定"/></DOS头><PE头 description=""><IMAGE_NT_HEADERS name="PE头" size="240"><Signature description="对应于ASCII码的字符串&quot;PE\0\0&quot;" name="PE头标识" size="4"/><IMAGE_FILE_HEADER description="该结构在微软的官方文档中被称为标准通用对象文件格式（Common Object File Format，COFF）头。它记录了PE文件的全局属性，如该PE文件运行的平台、PE文件类型、文件中存在的节总数等。" name="标准PE头" size="20"><Machine description="运行平台" size="word"/><NumberOfSections description="PE中节的数量" size="word"/><TimeDateStamp description="文件创建日期和时间" size="dword"/><PointerToSymbolTable description="指向符号表(用于调试)" size="dword"/><NumberOfSymbols description="符号表中的符号数量（用于调试）" size="dword"/><SizeOfOptionalHeader description="扩展头的长度" size="word"/><Characteristics description="文件属性" size="word"/></IMAGE_FILE_HEADER><IMAGE_OPTIONAL_HEADER32 name="扩展PE头" size="216"><Magic description="魔术字 107h=ROM Image，10Bh=exe Image" size="word"/><MajorLinkerVersion description="链接器版本号" size="byte"/><MinorLinkerVersion description="链接器版本号" size="byte"/><SizeOfCode description="所有含代码的节的总大小" size="dword"/><SizeOfInitializedData description="所有含已初始化数据的节的总大小" size="dword"/><SizeOfUninitializedData description="所有含未初始化数据的节的总大小" size="dword"/><AddressOfEntryPoint description="程序执行入口RVA" size="dword"/><BaseOfCode description="代码的节的起始RVA" size="dword"/><BaseOfData description="数据的节的起始RVA" size="dword"/><ImageBase description="程序的建议装载地址" size="dword"/><SectionAlignment description="内存中节的对齐粒度" size="dword"/><FileAlignment description="文件中的节的对齐粒度" size="dword"/><MajorOperatingSystemVersion description="操作系统的版本号" size="word"/><MinorOperationgSystemVersion description="操作系统版本号" size="word"/><MajorImageVersion description="该PE的版本号" size="word"/><MinorImageVersion description="该PE的版本号" size="word"/><MajorSubsystemVersion description="所需子系统的版本号" size="word"/><MinorSubsystemVersion description="所需子系统的版本所需子系统的版本号 " size="word"/><Win32VersionValue description="未用" size="dword"/><SizeOfImage description="内存中的整个PE映像尺寸" size="dword"/><SizeOfHeaders description="所有头+节表的大小" size="dword"/><CheckSum description="校验和" size="dword"/><Subsystem description="文件的子系统" size="word"/><DllCharacteristics description="Dll文件特性" size="word"/><SizeOfStackReserve description="初始化时的栈大小" size="dword"/><SizeOfStackCommit description="初始化时实际提交的栈大小" size="dword"/><SizeOfHeapReserve description="初始化时保留的堆大小" size="dword"/><SizeOfHeapCommit description="初始化时实际提交的堆大小" size="dword"/><LoaderFlags description="与调试有关" size="dword"/><NumberOfRvaAndSizes description="下面的数据目录结构的项目数量" size="dword"/><DataDirectory description="数据目录中定义的数据类型一直都是16种。PE中使用了一种称作“数据目录项IMAGE_DATA_DIRECTORY”的数据结构来定义每种数据。 16种数据目录类型分别为： 0、导出表 1、导入表 2、资源表 3、异常表 4、属性证书数据 5、基地址重定位表 6、调试信息 7、Architecture-specific data, 预留为0 8、Global pointer register relative virtual address, 指向全局指针寄存器的值 9、线程局部存储 10、加载配置表 11、绑定导入表 12、导入函数地址表 13、延迟导入表 14、CLR运行时头部数据地址 15、系统保留" name="数据目录" size="IMAGE_DATA_DIRECTORY 16 dup"><IMAGE_DATA_DIRECTORY size="8"><VirtualAddress description="数据的起始RVA" size="dword"/><isize description="数据块的长度" size="dword"/></IMAGE_DATA_DIRECTORY></DataDirectory></IMAGE_OPTIONAL_HEADER32></IMAGE_NT_HEADERS></PE头><节表 description=""><IMAGE_SECTION_HEADER description="节表项中记录了PE中与某个特定的节有关的信息，如节的属性、节的大小、在文件和内存中的起始位置等" size="n*40"><Name1 description="8个字节节名" size="dq"/><union_Misc size="dd"><PhysicalAddress description="" size="dd"/><VirtualAddress description="节区的尺寸" size="dd"/></union_Misc><VirtualAddress description="节区的RVA地址" size="dd"/><SizeOfRawData description="在文件中对齐后的尺寸" size="dd"/><PointerToRawData description="在文件中的偏移" size="dd"/><PointerToRelocations description="在OBJ文件中使用" size="dd"/><PointerToLinenumbers description="行号表的位置（供调试用）" size="dd"/><NumberOfRelocations description="在OBJ文件中使用" size="dw"/><NumberOfLinenumbers description="行号表中的行号数量" size="dw"/><Characteristics description="节的属性" size="dd"/></IMAGE_SECTION_HEADER></节表></PE文件头部><PE文件身体 description=""><节内容 description=""/></PE文件身体></PE文件结构>