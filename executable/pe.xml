<?xml version="1.0" encoding="utf-8"?><PE文件结构 description="这是一个PE格式的树状结构。"><PE文件头部><description> </description><DOS头><description>为了保持与16位系统的兼容，PE里依旧保留了16位系统下的标准可执行程序执行时所必需的文件头(DOS MZ 头)和指令代码(DOS Stub)</description><IMAGE_DOS_HEADER><name>DOS MZ头</name><size>64</size><e_magic><description>EXE标志，“MZ”</description><size>word</size></e_magic><e_cblp><description>最后(部分)页中的字节数</description><size>word</size></e_cblp><e_cp><description>文件中的全部和部分页数</description><size>word</size></e_cp><e_crlc><description>重定位表中指针数</description><size>word</size></e_crlc><e_cparhdr><description>头部尺寸，以段落为单位</description><size>word</size></e_cparhdr><e_minalloc><description>所需最小附加段</description><size>word</size></e_minalloc><e_maxalloc><description>所需的最大附加段</description><size>word</size></e_maxalloc><e_ss><description>初始的SS值(相对偏移量)</description><size>word</size></e_ss><e_sp><description>初始的SP值</description><size>word</size></e_sp><e_csum><description>补码校验值</description><size>word</size></e_csum><e_ip><description>初始的IP值</description><size>word</size></e_ip><e_cs><description>初始的CS值</description><size>word</size></e_cs><e_lfarlc><description>重定位表的字节偏移量</description><size>word</size></e_lfarlc><e_ovno><description>覆盖号</description><size>word</size></e_ovno><e_res><description>保留字</description><size>word 4 dup</size></e_res><e_oemid><description>OEM标识符(相对e_oeminfo)</description><size>word</size></e_oemid><e_oeminfo><description>OEM信息</description><size>word</size></e_oeminfo><e_res2><description>保留字</description><size>word 10 dup</size></e_res2><e_lfanew><description>PE头相对于文件的偏移地址</description><size>dword</size></e_lfanew></IMAGE_DOS_HEADER><DOS_Stub><description>DOS Stub 部分是程序在DOS系统下的指令字节码</description><size>不确定</size></DOS_Stub></DOS头><PE头><description> </description><IMAGE_NT_HEADERS><name>PE头</name><size>240</size><Signature><size>4</size><description>对应于ASCII码的字符串&quot;PE\0\0</description><name>PE头标识</name></Signature><IMAGE_FILE_HEADER><description>该结构在微软的官方文档中被称为标准通用对象文件格式（Common Object File Format，COFF）头。它记录了PE文件的全局属性，如该PE文件运行的平台、PE文件类型、文件中存在的节总数等。</description><name>标准PE头</name><size>20</size><Machine><description>运行平台</description><size>word</size></Machine><NumberOfSections><description>PE中节的数量</description><size>word</size></NumberOfSections><TimeDateStamp><description>文件创建日期和时间</description><size>dword</size></TimeDateStamp><PointerToSymbolTable><description>指向符号表(用于调试)</description><size>dword</size></PointerToSymbolTable><NumberOfSymbols><description>符号表中的符号数量（用于调试）</description><size>dword</size></NumberOfSymbols><SizeOfOptionalHeader><description>扩展头的长度</description><size>word</size></SizeOfOptionalHeader><Characteristics><description>文件属性</description><size>word</size></Characteristics></IMAGE_FILE_HEADER><IMAGE_OPTIONAL_HEADER32><description>扩展PE头</description><size>216</size><Magic><description>魔术字 107h=ROM Image，10Bh=exe Image</description><size>word</size></Magic><MajorLinkerVersion><description>链接器版本号</description><size>byte</size></MajorLinkerVersion><MinorLinkerVersion><description>链接器版本号</description><size>byte</size></MinorLinkerVersion><SizeOfCode><description>所有含代码的节的总大小</description><size>dword</size></SizeOfCode><SizeOfInitializedData><description>所有含已初始化数据的节的总大小</description><size>dword</size></SizeOfInitializedData><SizeOfUninitializedData><description>所有含未初始化数据的节的总大小</description><size>dword</size></SizeOfUninitializedData><AddressOfEntryPoint><description>程序执行入口RVA</description><size>dword</size></AddressOfEntryPoint><BaseOfCode><description>代码的节的起始RVA</description><size>dword</size></BaseOfCode><BaseOfData><description>数据的节的起始RVA</description><size>dword</size></BaseOfData><ImageBase><description>程序的建议装载地址</description><size>dword</size></ImageBase><SectionAlignment><description>内存中节的对齐粒度</description><size>dword</size></SectionAlignment><FileAlignment><description>文件中的节的对齐粒度</description><size>dword</size></FileAlignment><MajorOperatingSystemVersion><description>操作系统的版本号</description><size>word</size></MajorOperatingSystemVersion><MinorOperationgSystemVersion><description> 操作系统版本号</description><size>word</size></MinorOperationgSystemVersion><MajorImageVersion><description>该PE的版本号</description><size>word</size></MajorImageVersion><MinorImageVersion><description>该PE的版本号</description><size>word</size></MinorImageVersion><MajorSubsystemVersion><description>所需子系统的版本号</description><size>word</size></MajorSubsystemVersion><MinorSubsystemVersion><description>所需子系统的版本号</description><size>word</size></MinorSubsystemVersion><Win32VersionValue><description>未用</description><size>dword</size></Win32VersionValue><SizeOfImage><description>内存中的整个PE映像尺寸</description><size>dword</size></SizeOfImage><SizeOfHeaders><description>所有头+节表的大小</description><size>dword</size></SizeOfHeaders><CheckSum><description>校验和</description><size>dword</size></CheckSum><Subsystem><description>文件的子系统</description><size>word</size></Subsystem><DllCharacteristics><description>Dll文件特性</description><size>word</size></DllCharacteristics><SizeOfStackReserve><description>初始化时的栈大小</description><size>dword</size></SizeOfStackReserve><SizeOfStackCommit><description>初始化时实际提交的栈大小</description><size>dword</size></SizeOfStackCommit><SizeOfHeapReserve><description>初始化时保留的堆大小</description><size>dword</size></SizeOfHeapReserve><SizeOfHeapCommit><description>初始化时实际提交的堆大小</description><size>dword</size></SizeOfHeapCommit><LoaderFlags><description>与调试有关</description><size>dword</size></LoaderFlags><NumberOfRvaAndSizes><description>下面的数据目录结构的项目数量</description><size>dword</size></NumberOfRvaAndSizes><DataDirectory><description>数据目录中定义的数据类型一直都是16种。PE中使用了一种称作“数据目录项IMAGE_DATA_DIRECTORY”的数据结构来定义每种数据。 16种数据目录类型

分别为： 
0、导出表 
1、导入表 
2、资源表 
3、异常表 
4、属性证书数据 
5、基地址重定位表 
6、调试信息 
7、Architecture-specific data, 预留为0 
8、Global pointer register relative virtual address, 指向全局指针寄存器的值 
9、线程局部存储 
10、加载配置表 
11、绑定导入表 
12、导入函数地址表 
13、延迟导入表 
14、CLR运行时头部数据地址 
15、系统保留</description><name>数据目录</name><size>IMAGE_DATA_DIRECTORY 16 dup</size><IMAGE_DATA_DIRECTORY><size>8</size><VirtualAddress><description>数据的起始RVA</description><size>dword</size></VirtualAddress><isize><description>数据块的长度</description><size>dword</size></isize></IMAGE_DATA_DIRECTORY></DataDirectory></IMAGE_OPTIONAL_HEADER32></IMAGE_NT_HEADERS></PE头><节表><description> </description><IMAGE_SECTION_HEADER><description>节表项中记录了PE中与某个特定的节有关的信息，如节的属性、节的大小、在文件和内存中的起始位置等</description><size>40</size><Name1><description>8个字节节名，不以\0结尾，超过部分直接截断</description><size>8</size></Name1><union_Misc><size>dd</size></union_Misc><VirtualAddress><description>节区的RVA地址</description><size>dd</size></VirtualAddress><SizeOfRawData><description>在文件中对齐后的尺寸</description><size>dd</size></SizeOfRawData><PointerToRawData><description>在文件中的偏移</description><size>dd</size></PointerToRawData><PointerToRelocations><description>在OBJ文件中使用</description><size>dd</size></PointerToRelocations><PointerToLinenumbers><description>行号表的位置（供调试用）</description><size>dd</size></PointerToLinenumbers><NumberOfRelocations><description>在OBJ文件中使用</description><size>dword</size></NumberOfRelocations><NumberOfLinenumbers><description>行号表中的行号数量</description><size>dword</size></NumberOfLinenumbers><Characteristics><description>节的属性</description><size>dd</size></Characteristics></IMAGE_SECTION_HEADER></节表></PE文件头部><PE文件身体><description> </description></PE文件身体></PE文件结构>